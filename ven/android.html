<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Marathon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cross-platform test runner written for Android and iOS projects">
    <meta name="keywords" content="android, testing, testing-tool, test-runner, espresso, uitest, uitesting, uitests, ios, marathon, xcrun, instrumentation, instrumentation-tests, gradle, parallel, performance">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet"
          type="text/css">
    <!-- Animated -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="shortcut icon" href="/marathon/img/favicon.png">
    <!-- highlight  css -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.1/styles/solarized-dark.min.css">
    <!-- main css -->
    <link rel="stylesheet" type="text/css" href="/marathon/css/marathon.css">
    <!-- tabs -->
    <link rel="stylesheet" type="text/css" href="/marathon/css/tabs.css">

    <!-- Diagrams support -->
    <script src="/marathon/js/dagre.min.js"></script>
    <script src="/marathon/js/lodash.min.js"></script>
    <script src="/marathon/js/nomnoml.js"></script>
    <script src="/marathon/js/diagrams.js"></script>

    
    <script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-131132823-2', 'auto');
    ga('send', 'pageview');


</script>

    
</head>

<body id="doc-body">
<div id="wrapper">
    <div id="sidebar-wrapper">
    <div>
      <a class="brand" href="/marathon/">
            <img src="/marathon/img/marathon-brand-sidebar.svg" alt="">
      </a>
      <a href="javascript:void(0)" id="main-toggle" class="sidebar-toggle">
            <i class="fa fa-bars"></i>
      </a>
    </div>
    <ul class="sidebar-nav">
    
        
        
        <li class="sidebar-nav-item">
          <a href="#">
            <span>General</span>
            <i class="fa fa-angle-down"></i>
          </a>
          <ul>
            
            
            <li data-order="1">
              <a href="/marathon/doc/getting-started.html">
                  <i class="fa fa-circle"></i>
                  <span>Getting Started</span>
              </a>
            </li>
            
            <li data-order="2">
              <a href="/marathon/doc/downloading.html">
                  <i class="fa fa-circle"></i>
                  <span>Downloading</span>
              </a>
            </li>
            
            <li data-order="3">
              <a href="/marathon/doc/configuration.html">
                  <i class="fa fa-circle"></i>
                  <span>Options</span>
              </a>
            </li>
            
            <li data-order="5">
              <a href="/marathon/doc/executing.html">
                  <i class="fa fa-circle"></i>
                  <span>Executing</span>
              </a>
            </li>
            
            <li data-order="6">
              <a href="/marathon/doc/reports.html">
                  <i class="fa fa-circle"></i>
                  <span>Reporting</span>
              </a>
            </li>
            
            <li data-order="7">
              <a href="/marathon/doc/faq.html">
                  <i class="fa fa-circle"></i>
                  <span>FAQ</span>
              </a>
            </li>
            
            <li data-order="8">
              <a href="/marathon/doc/special-thanks.html">
                  <i class="fa fa-circle"></i>
                  <span>Special thanks</span>
              </a>
            </li>
            
          </ul>
        </li>
    
        
        
        <li class="sidebar-nav-item">
          <a href="#">
            <span>Reference</span>
            <i class="fa fa-angle-down"></i>
          </a>
          <ul>
            
            
            <li data-order="">
              <a href="/marathon/ref/samples.html">
                  <i class="fa fa-circle"></i>
                  <span>Samples</span>
              </a>
            </li>
            
          </ul>
        </li>
    
        
        
        <li class="sidebar-nav-item">
          <a href="#">
            <span>Vendor extensions</span>
            <i class="fa fa-angle-down"></i>
          </a>
          <ul>
            
            
            <li data-order="1">
              <a href="/marathon/ven/android.html">
                  <i class="fa fa-circle"></i>
                  <span>Android</span>
              </a>
            </li>
            
            <li data-order="2">
              <a href="/marathon/ven/ios.html">
                  <i class="fa fa-circle"></i>
                  <span>iOS</span>
              </a>
            </li>
            
          </ul>
        </li>
    
        
        
        <li class="sidebar-nav-item">
          <a href="#">
            <span>Developers</span>
            <i class="fa fa-angle-down"></i>
          </a>
          <ul>
            
            
            <li data-order="2">
              <a href="/marathon/dev/contributing.html">
                  <i class="fa fa-circle"></i>
                  <span>Contributing</span>
              </a>
            </li>
            
            <li data-order="3">
              <a href="/marathon/dev/vision.html">
                  <i class="fa fa-circle"></i>
                  <span>Vision</span>
              </a>
            </li>
            
          </ul>
        </li>
    
    </ul>

</div>

    <div id="doc-wrapper">
    <div class="doc-header">
        <a href="javascript:void(0)" id="main-toggle" class="sidebar-toggle">
            <i class="fa fa-bars"></i>
        </a>
        <div class="search-wrapper">
            <input class="search" id="docsearch" placeholder="Search documentation..." type="search">
        </div>
    </div>
    <div class="doc-content">
        
        <ul id="markdown-toc">
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a>    <ul>
      <li><a href="#cli" id="markdown-toc-cli">CLI</a></li>
    </ul>
  </li>
  <li><a href="#required-options" id="markdown-toc-required-options">Required options</a>    <ul>
      <li><a href="#android-sdk-path" id="markdown-toc-android-sdk-path">Android SDK path</a></li>
      <li><a href="#application-apk-path" id="markdown-toc-application-apk-path">Application APK path</a></li>
      <li><a href="#test-application-apk-path" id="markdown-toc-test-application-apk-path">Test application APK path</a></li>
    </ul>
  </li>
  <li><a href="#optional" id="markdown-toc-optional">Optional</a>    <ul>
      <li><a href="#automatic-granting-of-permissions" id="markdown-toc-automatic-granting-of-permissions">Automatic granting of permissions</a></li>
      <li><a href="#adb-initialisation-timeout" id="markdown-toc-adb-initialisation-timeout">ADB initialisation timeout</a></li>
      <li><a href="#device-serial-number-assignment" id="markdown-toc-device-serial-number-assignment">Device serial number assignment</a></li>
      <li><a href="#install-options" id="markdown-toc-install-options">Install options</a></li>
      <li><a href="#screen-recorder-configuration" id="markdown-toc-screen-recorder-configuration">Screen recorder configuration</a></li>
      <li><a href="#clear-state-between-test-executions" id="markdown-toc-clear-state-between-test-executions">Clear state between test executions</a></li>
      <li><a href="#instrumentation-arguments" id="markdown-toc-instrumentation-arguments">Instrumentation arguments</a></li>
      <li><a href="#allure-kotlin-support" id="markdown-toc-allure-kotlin-support">Allure-kotlin support</a></li>
      <li><a href="#vendor-module-selection" id="markdown-toc-vendor-module-selection">Vendor module selection</a></li>
      <li><a href="#timeout-configuration" id="markdown-toc-timeout-configuration">Timeout configuration</a></li>
      <li><a href="#syncpull-files-from-device-after-test-run" id="markdown-toc-syncpull-files-from-device-after-test-run">Sync/pull files from device after test run</a></li>
    </ul>
  </li>
</ul>

<h1 id="prerequisites">Prerequisites</h1>
<p>In order to execute tests on Android devices marathon will need Android SDK
installed. Devices are expected to be connected to local machine by any means
supported by the adb (local usb connection, local emulator or TCP/IP).</p>

<h2 id="cli">CLI</h2>
<p>To indicate to CLI that you’re using a vendor config for android you have to specify
the <em>type</em> in the root of the <em>Marathonfile</em> configuration as following:</p>

<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  additional_option1: ...
  additional_option2: ...
</code></pre>

<h1 id="required-options">Required options</h1>
<h2 id="android-sdk-path">Android SDK path</h2>
<p>If you’re using gradle plugin then this option is automatically detected.</p>

<p>If you have an <code>ANDROID_HOME</code> environment variable then this option is automatically detected by the CLI as well.</p>

<p>If this is not the case then you have to specify this option manually:</p>

<ul class="tab" data-tab="53f05730-1c6a-4c85-adc1-a1d4408f42d3">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
</ul>
<ul class="tab-content" id="53f05730-1c6a-4c85-adc1-a1d4408f42d3">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  androidSdk: "/usr/share/local/android"
</code></pre>
</li>
    
</ul>

<h2 id="application-apk-path">Application APK path</h2>
<p>If you’re using gradle plugin then this option is automatically detected. If this is not the case
then you have to specify this option manually.</p>

<ul class="tab" data-tab="45264aa3-7e08-44b4-90e1-b4473a61cc81">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
</ul>
<ul class="tab-content" id="45264aa3-7e08-44b4-90e1-b4473a61cc81">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  applicationApk: "app/build/outputs/apk/debug/app-debug.apk"
</code></pre>
</li>
    
</ul>

<h2 id="test-application-apk-path">Test application APK path</h2>
<p>If you’re using gradle plugin then this option is automatically detected. If this is not the case
then you have to specify this option manually.</p>

<ul class="tab" data-tab="e0aaf759-7750-4f5a-8f15-87741ea697dc">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
</ul>
<ul class="tab-content" id="e0aaf759-7750-4f5a-8f15-87741ea697dc">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  testApplicationApk: "app/build/outputs/apk/androidTest/debug/app-debug.apk"
</code></pre>
</li>
    
</ul>

<h1 id="optional">Optional</h1>
<h2 id="automatic-granting-of-permissions">Automatic granting of permissions</h2>
<p>This option will grant all runtime permissions during the installation of the
application. This works like the option <code>-g</code> for <a href="https://developer.android.com/studio/command-line/adb#issuingcommands"><code>adb install</code></a> command. By default, it’s set to <strong>false</strong>.</p>

<ul class="tab" data-tab="0543f07e-40d0-4b91-a775-6bce31cef330">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="0543f07e-40d0-4b91-a775-6bce31cef330">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  autoGrantPermission: true
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    autoGrantPermission = true
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    autoGrantPermission = true
}
</code></pre>
</li>
    
</ul>

<h2 id="adb-initialisation-timeout">ADB initialisation timeout</h2>
<p>This option will allow you to increase/decrease the default adb init timeout of 30
seconds.</p>

<ul class="tab" data-tab="40a62bd8-b678-447c-9f57-9a9313fc4801">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="40a62bd8-b678-447c-9f57-9a9313fc4801">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  adbInitTimeoutMillis: 60000
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    adbInitTimeout = 100000
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    adbInitTimeout = 100000
}
</code></pre>
</li>
    
</ul>

<h2 id="device-serial-number-assignment">Device serial number assignment</h2>
<p>This option allows to customise how marathon assigns a serial number to devices.
Possible values are:</p>
<ul>
  <li><code>automatic</code></li>
  <li><code>marathon_property</code></li>
  <li><code>boot_property</code></li>
  <li><code>hostname</code></li>
  <li><code>ddms</code></li>
</ul>

<ul class="tab" data-tab="9acaae2d-2c33-4ac6-b0f0-77747ad37949">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="9acaae2d-2c33-4ac6-b0f0-77747ad37949">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  serialStrategy: "automatic"
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    serialStrategy = com.malinskiy.marathon.android.serial.SerialStrategy.AUTOMATIC
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    serialStrategy = com.malinskiy.marathon.android.serial.SerialStrategy.AUTOMATIC
}
</code></pre>
</li>
    
</ul>

<p>Notes on the source of serial number:</p>

<p><code>marathon_property</code> - Property name <code>marathon.serialno</code></p>

<p><code>boot_property</code> - Property name <code>ro.boot.serialno</code></p>

<p><code>hostname</code> - Property name <code>net.hostname</code></p>

<p><code>ddms</code> - Adb serial number(same as you see with <code>adb devices</code> command)</p>

<p><code>automatic</code> - Sequantially checks all available options for first non empty value.</p>

<p>Priority order:</p>

<p>Before 0.6: <code>marathon_property</code> -&gt; <code>boot_property</code> -&gt; <code>hostname</code> -&gt; <code>ddms</code> -&gt; UUID</p>

<p>After 0.6:  <code>marathon_property</code> -&gt; <code>ddms</code> -&gt; <code>boot_property</code> -&gt; <code>hostname</code> -&gt; UUID</p>

<h2 id="install-options">Install options</h2>
<p>By default, these will be <code>-g -r</code> (<code>-r</code> prior to marshmallow). You can specify additional options to append to the default ones.</p>

<ul class="tab" data-tab="974056fd-0175-47e8-a8f1-fc2698b6c196">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="974056fd-0175-47e8-a8f1-fc2698b6c196">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  installOptions: "-d"
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    installOptions = "-d"
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    installOptions = "-d"
}
</code></pre>
</li>
    
</ul>

<h2 id="screen-recorder-configuration">Screen recorder configuration</h2>
<p>By default, device will record a 1280x720 1Mbps video of up to 180 seconds if it is supported. If on the other hand you want to force
 screenshots or configure the recording parameters you can specify this as follows:</p>

<ul class="tab" data-tab="b5d99e4c-d5b0-46ff-8d7f-4c07cab3ad6e">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="b5d99e4c-d5b0-46ff-8d7f-4c07cab3ad6e">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  screenRecordConfiguration:
    preferableRecorderType: "screenshot"
    videoConfiguration:
      enabled: false
      width: 1080
      height: 1920
      bitrateMbps: 2
      timeLimit: 300
    screenshotConfiguration:
      enabled: false
      width: 1080
      height: 1920
      delayMs: 200
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    screenRecordConfiguration = ScreenRecordConfiguration(
        com.malinskiy.marathon.device.DeviceFeature.SCREENSHOT,
        VideoConfiguration(
            false, //enabled
            1080, //width
            1920, //height
            2, //Bitrate in Mbps
            300 //Max duration in seconds
        ),
        ScreenshotConfiguration(
            false, //enabled
            1080, //width
            1920, //height
            200 //Delay between taking screenshots
        )
    )
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    screenRecordConfiguration = ScreenRecordConfiguration(
        com.malinskiy.marathon.device.DeviceFeature.SCREENSHOT,
        VideoConfiguration(
            false, //enabled
            1080, //width
            1920, //height
            2, //Bitrate in Mbps
            300 //Max duration in seconds
        ),
        ScreenshotConfiguration(
            false, //enabled
            1080, //width
            1920, //height
            200 //Delay between taking screenshots
        )
    )
}
</code></pre>
</li>
    
</ul>

<h2 id="clear-state-between-test-executions">Clear state between test executions</h2>
<p>By default, marathon does not clear state between test batch executions. To mitigate potential test side-effects, one could add an option to clear the package data between test runs. Keep in mind that test side-effects might be present. 
If you want to isolate tests even further, then you should consider reducing the batch size.</p>

<p>Since <code>pm clear</code> resets the permissions of the package, the granting of permissions during installation is essentially overridden. Marathon doesn’t grant the permissions again. 
If you need permissions to be granted and you need to clear the state, consider alternatives like <a href="https://developer.android.com/reference/androidx/test/rule/GrantPermissionRule">GrantPermissionRule</a></p>

<ul class="tab" data-tab="18ec6560-665c-461b-9318-4164ec46d2f1">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="18ec6560-665c-461b-9318-4164ec46d2f1">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  applicationPmClear: true
  testApplicationPmClear: true
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    applicationPmClear = true
    testApplicationPmClear = true
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    applicationPmClear = true
    testApplicationPmClear = true
}
</code></pre>
</li>
    
</ul>

<h2 id="instrumentation-arguments">Instrumentation arguments</h2>
<p>If you want to pass additional arguments to the <code>am instrument</code> command executed on the device like execute only “SMALL” tests:</p>

<ul class="tab" data-tab="c1e86ae9-e7f5-41ba-bb04-33b61638d4d0">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="c1e86ae9-e7f5-41ba-bb04-33b61638d4d0">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  instrumentationArgs:
    size: small
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    instrumentationArgs { 
        set("size", "small")
    }
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    instrumentationArgs { 
        set("size", "small")
    }
}
</code></pre>
</li>
    
</ul>

<h2 id="allure-kotlin-support"><a href="https://github.com/allure-framework/allure-kotlin">Allure-kotlin</a> support</h2>
<p>If you want to enable on-device collection of allure’s reports, you can use the following option:</p>

<ul class="tab" data-tab="737addeb-0e96-40d8-87ef-2be7ca58bf23">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="737addeb-0e96-40d8-87ef-2be7ca58bf23">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  allureConfiguration:
      enabled: true
      relativeResultsDirectory: "/allure-results"
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    allureConfiguration {
        enabled = true
        relativeResultsDirectory = "/allure-results"
    }
}
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    allureConfiguration {
        enabled = true
        relativeResultsDirectory = "/allure-results"
    }
}
</code></pre>

</li>
    
</ul>

<p><strong>relativeResultsDirectory</strong> is the relative path to <code>$EXTERNAL_STORAGE</code> (<code>Environment.getExternalStorageDirectory()</code>) on the device where
allure is outputting it’s data. The default path for allure-kotlin is
<code>$EXTERNAL_STORAGE/allure-results</code>. Please refer to <a href="https://github.com/allure-framework/allure-kotlin">allure’s documentation</a> on the usage of allure.</p>

<p>Starting with Android 11 your test application will require MANAGE_EXTERNAL_STORAGE permission to write allure’s output:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"&gt;
  &lt;uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE"/&gt;
  ...
&lt;/manifest&gt;
</code></pre>
<p>Marathon will automatically grant this permission before executing tests if you’re using allure integration</p>

<p>Enabling this option effectively creates two allure reports for each test run:</p>
<ul>
  <li>one from the point of view of the marathon test runner</li>
  <li>one from the point of view of on-device test execution</li>
</ul>

<p>The on-device report gives you more flexibility and allows you to:</p>
<ul>
  <li>Take screenshots whenever you want</li>
  <li>Divide large tests into steps and visualise them in the report</li>
  <li>Capture window hierarchy
and more.</li>
</ul>

<p>All allure output from devices will be collected under <code>$output/allure-device-results</code> folder.</p>

<h2 id="vendor-module-selection">Vendor module selection</h2>
<p>The first implementation of marathon for Android relied heavily on AOSP’s <a href="https://android.googlesource.com/platform/tools/base/+/master/ddmlib">ddmlib</a>. For a number of technical reasons we had to write our
 own implementation of the ADB client named <a href="https://github.com/Malinskiy/adam">adam</a>.</p>

<p>The ddmlib’s implementation is going to be deprecated in marathon <strong>0.7.0</strong> and by default adam is going to be handling all communication with
 devices.</p>

<p>By <strong>0.8.0</strong>, ddmlib is going to be removed completely unless we find major issues.</p>

<p>All the features supported in ddmlib’s implementation transparently work without any changes. We ask you to test adam prior to the
 removal of ddmlib and submit your concerns/issues.</p>

<ul class="tab" data-tab="f71f836b-b966-43b9-be2e-8239f064904e">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="f71f836b-b966-43b9-be2e-8239f064904e">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
  type: "Android"
  vendor: ADAM
</code></pre>
</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    vendor = com.malinskiy.marathon.android.VendorType.ADAM
}
</code></pre>

</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    vendor = com.malinskiy.marathon.android.VendorType.ADAM
}
</code></pre>

</li>
    
</ul>

<h2 id="timeout-configuration">Timeout configuration</h2>

<p>With the introduction of <a href="https://github.com/Malinskiy/adam">adam</a> we can precisely control the timeout of individual requests. Here is how you can use it:</p>

<ul class="tab" data-tab="89324dbb-5f81-4d8c-8fc0-408220e2e504">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="89324dbb-5f81-4d8c-8fc0-408220e2e504">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
    type: "Android"
    vendor: ADAM
    timeoutConfiguration:
        # ISO_8601 duration
        shell: "PT30S"
        listFiles: "PT1M"
        pushFile: "PT1H"
        pullFile: "P1D"
        uninstall: "PT1S"
        install: "P1DT12H30M5S"
        screenrecorder: "PT1H"
        screencapturer: "PT1S"
</code></pre>

</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    timeoutConfiguration {
        shell = Duration.ofSeconds(30)
    }
}
</code></pre>

</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    timeoutConfiguration {
        shell = Duration.ofSeconds(30)
    }
}
</code></pre>

</li>
    
</ul>

<p>Please keep in mind that this timeout configuration is only for adam vendor, ddmlib will not pick up these settings.</p>

<h2 id="syncpull-files-from-device-after-test-run">Sync/pull files from device after test run</h2>

<p>Sometimes you need to pull some folders from each device after the test execution. It may be screenshots or logs or other debug information.
To help with this marathon supports pulling files from devices at the end of the test batch execution. Here is how you can configure it:</p>

<ul class="tab" data-tab="3165f7df-2fc2-483b-8a77-9c0b21a574be">
    
        <li class="active">
            <a href="">Marathonfile </a>
        </li>
    
        <li>
            <a href="">Gradle Kotlin </a>
        </li>
    
</ul>
<ul class="tab-content" id="3165f7df-2fc2-483b-8a77-9c0b21a574be">
    
        <li class="active">
<pre><code class="language-yaml">vendorConfiguration:
    type: "Android"
    fileSyncConfiguration:
        pull:
            - relativePath: "my-device-folder1"
              aggregationMode: TEST_RUN
            - relativePath: "my-device-folder2"
              aggregationMode: DEVICE
            - relativePath: "my-device-folder3"
              aggregationMode: DEVICE_AND_POOL
            - relativePath: "my-device-folder4"
              aggregationMode: POOL
</code></pre>

</li>
    
        <li>
<pre><code class="language-kotlin">marathon {
    fileSyncConfiguration {
        pull.add(
            com.malinskiy.marathon.android.configuration.FileSyncEntry(
                "my-device-folder1",
                com.malinskiy.marathon.android.configuration.AggregationMode.TEST_RUN
            )
        )
        pull.add(
            com.malinskiy.marathon.android.configuration.FileSyncEntry(
                "my-device-folder2",
                com.malinskiy.marathon.android.configuration.AggregationMode.DEVICE
            )
        )
        pull.add(
            com.malinskiy.marathon.android.configuration.FileSyncEntry(
                "my-device-folder3",
                com.malinskiy.marathon.android.configuration.AggregationMode.DEVICE_AND_POOL
            )
        )
        pull.add(
            com.malinskiy.marathon.android.configuration.FileSyncEntry(
                "my-device-folder4",
                com.malinskiy.marathon.android.configuration.AggregationMode.POOL
            )
        )
    }
}
</code></pre>

</li>
    
</ul>

<p>Please pay attention to the path on the device: it’s a relative path to the <code>Environment.getExternalStorageDirectory()</code> or
the <code>EXTERNAL_STORAGE</code> envvar. In practice this means that if you have a folder like <code>/sdcard/my-folder</code> you should specify <code>/my-folder</code> as
a relative path.</p>

<p>Starting with Android 11 your test application will require MANAGE_EXTERNAL_STORAGE permission:</p>

<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE"/&gt;
    ...
&lt;/manifest&gt;
</code></pre>

<p>Marathon will automatically grant this permission before executing tests if you pull any files from devices.</p>


    </div>
</div>

</div>
<!-- Jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Highlight -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.1/highlight.min.js"></script>
<script> hljs.initHighlighting(); </script>
<!-- Docsearch -->
<script src="/marathon/js/docsearch.min.js" type="text/javascript"></script>
<!-- Touch gesture support -->
<script src="/marathon/js/hammer.min.js"></script>
<!-- Custom scripts for this template -->
<script src="/marathon/js/functions.js"></script>
<script src="/marathon/js/tabs.js"></script>

</body>
</html>
